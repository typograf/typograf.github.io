!function(){"use strict";function e(t,n){var i=l[t];if(!i)return console.warn('Not found key "'+t+'" in getText().'),"";var s=n||e.lang,a=i[s];return void 0===a?(console.warn('Not found key "'+t+'", lang "'+s+'" in getText().'),""):a}"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=(function(){function e(e){this.value=e}function t(t){function n(s,a){try{var o=t[s](a),r=o.value;r instanceof e?Promise.resolve(r.value).then(function(e){n("next",e)},function(e){n("throw",e)}):i(o.done?"return":"normal",o.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":s.resolve({value:t,done:!0});break;case"throw":s.reject(t);break;default:s.resolve({value:t,done:!1})}(s=s.next)?n(s.key,s.arg):a=null}var s,a;this._invoke=function(e,t){return new Promise(function(i,o){var r={key:e,arg:t,resolve:i,reject:o,next:null};a?a=a.next=r:(s=a=r,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();(function(e,t){return t={exports:{}},e(t,t.exports),t.exports})(function(e,n){!function(t,n){e.exports=n()}(0,function(){return{init:function(e){if(!this._inited){var t=this,n=/(Android|iPhone|iPod|iPad)/i.test(navigator.userAgent);this.settings=e||{},this._inited=!0,this._isLast=!0,this._i=0,this._buffer=[],this._onerror=function(e){n&&e&&"Script error."===e.message&&!e.lineno&&!e.filename||(t._buffer.push(e),t._isLast&&(t._i=t._buffer.length-1),t._update())},window.addEventListener?window.addEventListener("error",this._onerror,!1):(this._oldOnError=window.onerror,window.onerror=function(e,n,i,s,a){t._onerror({message:e,filename:n,lineno:i,colno:s,error:a}),"function"==typeof t._oldOnError&&t._oldOnError.apply(window,arguments)})}},destruct:function(){this._inited&&(window.addEventListener?window.removeEventListener("error",this._onerror,!1):(window.onerror=this._oldOnError||null,delete this._oldOnError),document.body&&this._container&&document.body.removeChild(this._container),this._buffer=[],this._inited=!1)},show:function(e){void 0!==e&&this._buffer.push("object"===(void 0===e?"undefined":t(e))?e:new Error(e)),this._update(),this._show()},hide:function(){this._container&&(this._container.className=this.elemClass(""))},copyText:function(){var e=this._buffer[this._i],t=this._getDetailedMessage(e),n=document.body,i=this.elem({name:"textarea",tag:"textarea",props:{innerHTML:t},container:n});try{i.select(),document.execCommand("copy")}catch(e){alert("Copying text is not supported in this browser.")}n.removeChild(i)},elem:function(e){var t=document.createElement(e.tag||"div"),n=e.props;for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);return t.className=this.elemClass(e.name),e.container.appendChild(t),t},elemClass:function(e,t){var n="show-js-error";return e&&(n+="__"+e),t&&(n+=" "+n+"_"+t),n},escapeHTML:function(e){return(e||"").replace(/[&<>"'\/]/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"}[e]})},toggleDetailed:function(){var e=this._body;e&&(this._toggleDetailed?(this._toggleDetailed=!1,e.className=this.elemClass("body")):(this._toggleDetailed=!0,e.className=this.elemClass("body","detailed")))},_append:function(){var e=this;this._container=document.createElement("div"),this._container.className=this.elemClass(""),this._title=this.elem({name:"title",props:{innerHTML:this._getTitle()},container:this._container}),this._body=this.elem({name:"body",container:this._container}),this._message=this.elem({name:"message",props:{onclick:function(){e.toggleDetailed()}},container:this._body}),this.settings.helpLinks&&(this._helpLinks=this.elem({name:"help",container:this._body}),this._mdn=this.elem({tag:"a",name:"mdn",props:{target:"_blank",innerHTML:"MDN"},container:this._helpLinks}),this._stackoverflow=this.elem({tag:"a",name:"stackoverflow",props:{target:"_blank",innerHTML:"Stack Overflow"},container:this._helpLinks})),this._filename=this.elem({name:"filename",container:this._body}),this.settings.userAgent&&(this._ua=this.elem({name:"ua",container:this._body})),this.settings.additionalText&&(this._additionalText=this.elem({name:"additional-text",container:this._body})),this.elem({name:"close",props:{innerHTML:"\xd7",onclick:function(){e.hide()}},container:this._container}),this._actions=this.elem({name:"actions",container:this._container}),this.elem({tag:"input",name:"copy",props:{type:"button",value:this.settings.copyText||"Copy",onclick:function(){e.copyText()}},container:this._actions}),this.settings.sendUrl&&(this._sendLink=this.elem({tag:"a",name:"send-link",props:{href:"",target:"_blank"},container:this._actions}),this._send=this.elem({tag:"input",name:"send",props:{type:"button",value:this.settings.sendText||"Send"},container:this._sendLink})),this._arrows=this.elem({tag:"span",name:"arrows",container:this._actions}),this._prev=this.elem({tag:"input",name:"prev",props:{type:"button",value:"\u2190",onclick:function(){e._isLast=!1,e._i&&e._i--,e._update()}},container:this._arrows}),this._next=this.elem({tag:"input",name:"next",props:{type:"button",value:"\u2192",onclick:function(){e._isLast=!1,e._i<e._buffer.length-1&&e._i++,e._update()}},container:this._arrows}),this._num=this.elem({tag:"span",name:"num",props:{innerHTML:this._i+1},container:this._arrows});var t=function(){document.body.appendChild(e._container)};document.body?t():document.addEventListener?document.addEventListener("DOMContentLoaded",t,!1):document.attachEvent&&document.attachEvent("onload",t)},_getDetailedMessage:function(e){for(var n=this.settings,i="object"===t(window.screen)?window.screen:{},s=i.orientation||i.mozOrientation||i.msOrientation||"",a=[["Title",e.title||this._getTitle()],["Message",this._getMessage(e)],["Filename",this._getFilenameWithPosition(e)],["Stack",this._getStack(e)],["Page url",window.location.href],["Refferer",document.referrer],["User-agent",n.userAgent||navigator.userAgent],["Screen size",[i.width,i.height,i.colorDepth].join("\xd7")],["Screen orientation","string"==typeof s?s:s.type],["Cookie enabled",navigator.cookieEnabled]],o="",r=0;r<a.length;r++){var l=a[r];o+=l[0]+": "+l[1]+"\n"}return n.templateDetailedMessage&&(o=n.templateDetailedMessage.replace(/\{message\}/,o)),o},_getExtFilename:function(e){var t=e.filename,n=this.escapeHTML(this._getFilenameWithPosition(e));return t&&t.search(/^(https?|file):/)>-1?'<a target="_blank" href="'+this.escapeHTML(t)+'">'+n+"</a>":n},_get:function(e,t){return void 0!==e?e:t},_getFilenameWithPosition:function(e){var t=e.filename||"";return void 0!==e.lineno&&(t+=":"+this._get(e.lineno,""),void 0!==e.colno&&(t+=":"+this._get(e.colno,""))),t},_getMessage:function(e){var t=e.message;return e.error&&e.error.name&&"number"in e.error&&(t=e.error.name+": "+t),t},_getStack:function(e){return e.error&&e.error.stack||e.stack||""},_getTitle:function(){return this.settings.title||"JavaScript error"},_show:function(){this._container.className=this.elemClass("","visible")},_highlightLinks:function(e){return e.replace(/(at | \(|@)(https?|file)(:.*?)(?=:\d+:\d+\)?$)/gm,function(e,t,n,i){var s=n+i;return t+'<a target="_blank" href="'+s+'">'+s+"</a>"})},_update:function(){this._appended||(this._append(),this._appended=!0);var e,t=this._buffer[this._i],n=this._getStack(t);e=n?this._highlightLinks(this.escapeHTML(n)):this._getExtFilename(t),this._title.innerHTML=this.escapeHTML(t.title||this._getTitle()),this._message.innerHTML=this.escapeHTML(this._getMessage(t)),this._filename.innerHTML=e,this._ua&&(this._ua.innerHTML=this.escapeHTML(this.settings.userAgent)),this._additionalText&&(this._additionalText.innerHTML=this.escapeHTML(this.settings.additionalText)),this._sendLink&&(this._sendLink.href=this.settings.sendUrl.replace(/\{title\}/,encodeURIComponent(this._getMessage(t))).replace(/\{body\}/,encodeURIComponent(this._getDetailedMessage(t)))),this._buffer.length>1&&(this._arrows.className=this.elemClass("arrows","visible")),this._helpLinks&&(this._mdn.href="https://developer.mozilla.org/en-US/search?q="+encodeURIComponent(t.message||t.stack||""),this._stackoverflow.href="https://stackoverflow.com/search?q="+encodeURIComponent("[js] "+(t.message||t.stack||""))),this._prev.disabled=!this._i,this._num.innerHTML=this._i+1+"&thinsp;/&thinsp;"+this._buffer.length,this._next.disabled=this._i===this._buffer.length-1,this._show()}}})}).init({title:"JavaScript error",userAgent:navigator.userAgent,sendText:"Send \ud83d\udc1b",templateDetailedMessage:"```{message}```",sendUrl:"https://github.com/typograf/typograf.github.io/issues/new?title={title}&body={body}"}),$.fn.checked=function(e){var t=this[0];return arguments.length?(void 0===e?t.indeterminate=!0:(t.indeterminate=!1,t.checked=e),this):t.checked};var s=window.Typograf;s.groupsByName={},s.groups.forEach(function(e,t){e.index=t,s.groupsByName[e.name]=e}),s.getGroupTitle=function(e,t){return s.groupsByName[e].title[t]},s.getGroupIndex=function(e){return s.groupsByName[e].index};var a="chrome";navigator.userAgent.search("YaBrowser")>-1&&(a="yabro"),"undefined"!=typeof InstallTrigger&&(a="firefox"),navigator.userAgent.search(" OPR/")>-1&&(a="opera"),$(".extension_"+a).show(),$("#version").text(window.Typograf.version);var o={escapeHTML:function(e){return(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},isHTML:function(e){return-1!==(e||"").search(/(<\/?[a-z]|<!|&[lg]t;)/i)},stripTags:function(e){return(e||"").replace(/<\/?[^>]+(>|$)/g,"")},truncate:function(e,t){return e?e.length>t?e.substr(0,t):e:""}};!function(e){function t(e){return window.encodeURIComponent(o.truncate(e||"",512))}var n=t(window.location.href),i=t(document.referrer);(new Image).src="https://mc.yandex.ru/watch/"+e+"?page-url="+n+"&page-ref="+i}(28700106);var r={getHashParams:function(){var e={};return window.location.hash.replace(/^#!/,"").split("&").forEach(function(t){var n=t.split("=");if(n.length>1&&void 0!==n[1])try{e[n[0]]=window.decodeURIComponent(n[1])}catch(t){e[n[0]]=n[1]}}),e},getHashParam:function(e){return this.getHashParams()[e]}},l={typograf:{"en-US":"Typograf",ru:"\u0422\u0438\u043f\u043e\u0433\u0440\u0430\u0444"},"to-typograf":{"en-US":"Make beautiful",ru:"\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u043a\u0440\u0430\u0441\u0438\u0432\u043e"},close:{"en-US":"Close",ru:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"},extension:{"en-US":"Extension for",ru:"\u0414\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0434\u043b\u044f"},prefs:{"en-US":"Settings",ru:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"},"lang-rule":{"en-US":"Language rules",ru:"\u042f\u0437\u044b\u043a \u043f\u0440\u0430\u0432\u0438\u043b"},"lang-ui":{"en-US":"UI language",ru:"\u042f\u0437\u044b\u043a \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430"},"html-entities":{"en-US":"HTML entities",ru:"HTML-\u0441\u0443\u0449\u043d\u043e\u0441\u0442\u0438"},example:{"en-US":"Example",ru:"\u041f\u0440\u0438\u043c\u0435\u0440"},"html-entities-example":{"en-US":'"A Z"',ru:'"\u0410 \u042f"'},"invisible-symbols":{"en-US":"for invisible symbols",ru:"\u0434\u043b\u044f \u043d\u0435\u0432\u0438\u0434\u0438\u043c\u044b\u0445 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"},names:{"en-US":"Names",ru:"\u0418\u043c\u0435\u043d\u0430"},digits:{"en-US":"Digits",ru:"\u0426\u0438\u0444\u0440\u044b"},copy:{"en-US":"Copy",ru:"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"},save:{"en-US":"Save",ru:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},notSupportCopy:{"en-US":"Your browser does not support copy text.",ru:"\u0412\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430."},notSupportSave:{"en-US":"Your browser does not support save text to a file.",ru:"\u0412\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 \u0432 \u0444\u0430\u0439\u043b."},"select-all":{"en-US":"Select all",ru:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0432\u0441\u0451"},default:{"en-US":"Default",ru:"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e"},"text:":{"en-US":"Text:",ru:"\u0422\u0435\u043a\u0441\u0442:"},clear:{"en-US":"Clear",ru:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c"},text:{"en-US":"Text",ru:"\u0422\u0435\u043a\u0441\u0442"},html:{"en-US":"HTML",ru:"HTML"},"diff-1":{"en-US":"Diffe",ru:"\u0418\u0437\u043c\u0435\u043d"},"diff-2":{"en-US":"rences",ru:"\u0435\u043d\u0438\u044f"},"input-text":{"en-US":"Input text",ru:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442"},result:{"en-US":"Result",ru:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442"},locale:{"en-US":"Locale",ru:"\u041b\u043e\u043a\u0430\u043b\u044c"},"full-version":{"en-US":"Full version",ru:"\u041f\u043e\u043b\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f"},"mobile-version":{"en-US":"Mobile version",ru:"\u041c\u043e\u0431\u0438\u043b\u044c\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f"},"report-error":{"en-US":"Report a error",ru:"\u0421\u043e\u043e\u0431\u0449\u0438\u0442\u044c \u043e\u0431 \u043e\u0448\u0438\u0431\u043a\u0435"},"powered-by":{"en-US":"Powered by",ru:"\u041d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435"},ru:{"en-US":"Russian",ru:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439"},"en-US":{"en-US":"English",ru:"\u0410\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0439"},"locale-be":{"en-US":"Belarusian",ru:"\u0411\u0435\u043b\u043e\u0440\u0443\u0441\u0441\u043a\u0430\u044f"},"locale-bg":{"en-US":"Bulgarian",ru:"\u0411\u043e\u043b\u0433\u0430\u0440\u0441\u043a\u0430\u044f"},"locale-ca":{"en-US":"Catalan",ru:"\u041a\u0430\u0442\u0430\u043b\u0430\u043d\u0441\u043a\u0430\u044f"},"locale-cs":{"en-US":"Czech",ru:"\u0427\u0435\u0448\u0441\u043a\u0430\u044f"},"locale-da":{"en-US":"Danish",ru:"\u0414\u0430\u0442\u0441\u043a\u0430\u044f"},"locale-de":{"en-US":"German",ru:"\u041d\u0435\u043c\u0435\u0446\u043a\u0430\u044f"},"locale-el":{"en-US":"Greek",ru:"\u0413\u0440\u0435\u0447\u0435\u0441\u043a\u0430\u044f"},"locale-en-GB":{"en-US":"English UK",ru:"\u0410\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0430\u044f"},"locale-en-US":{"en-US":"English US",ru:"\u0410\u043c\u0435\u0440\u0438\u043a\u0430\u043d\u0441\u043a\u0430\u044f"},"locale-eo":{"en-US":"Esperanto",ru:"\u042d\u0441\u043f\u0435\u0440\u0430\u043d\u0442\u043e"},"locale-es":{"en-US":"Spanish",ru:"\u0418\u0441\u043f\u0430\u043d\u0441\u043a\u0430\u044f"},"locale-et":{"en-US":"Estonian",ru:"\u042d\u0441\u0442\u043e\u043d\u0441\u043a\u0430\u044f"},"locale-fi":{"en-US":"Finnish",ru:"\u0424\u0438\u043d\u0441\u043a\u0430\u044f"},"locale-fr":{"en-US":"French",ru:"\u0424\u0440\u0430\u043d\u0446\u0443\u0437\u0441\u043a\u0430\u044f"},"locale-ga":{"en-US":"Irish",ru:"\u0418\u0440\u043b\u0430\u043d\u0434\u0441\u043a\u0430\u044f"},"locale-hu":{"en-US":"Hungarian",ru:"\u0412\u0435\u043d\u0433\u0435\u0440\u0441\u043a\u0430\u044f"},"locale-it":{"en-US":"Italian",ru:"\u0418\u0442\u0430\u043b\u044c\u044f\u043d\u0441\u043a\u0430\u044f"},"locale-lv":{"en-US":"Latvian",ru:"\u041b\u0430\u0442\u0432\u0438\u0439\u0441\u043a\u0430\u044f"},"locale-nl":{"en-US":"Dutch",ru:"\u0413\u043e\u043b\u043b\u0430\u043d\u0434\u0441\u043a\u0430\u044f"},"locale-no":{"en-US":"Norwegian",ru:"\u041d\u043e\u0440\u0432\u0435\u0436\u0441\u043a\u0430\u044f"},"locale-pl":{"en-US":"Polish",ru:"\u041f\u043e\u043b\u044c\u0441\u043a\u0430\u044f"},"locale-ro":{"en-US":"Romanian",ru:"\u0420\u0443\u043c\u044b\u043d\u0441\u043a\u0430\u044f"},"locale-ru":{"en-US":"Russian",ru:"\u0420\u0443\u0441\u0441\u043a\u0430\u044f"},"locale-sk":{"en-US":"Slovak",ru:"\u0421\u043b\u043e\u0432\u0430\u0446\u043a\u0430\u044f"},"locale-sl":{"en-US":"Slovenian",ru:"\u0421\u043b\u043e\u0432\u0435\u043d\u0441\u043a\u0430\u044f"},"locale-sr":{"en-US":"Serbian",ru:"\u0421\u0435\u0440\u0431\u0441\u043a\u0430\u044f"},"locale-sv":{"en-US":"Swedish",ru:"\u0428\u0432\u0435\u0434\u0441\u043a\u0430\u044f"},"locale-tr":{"en-US":"Turkish",ru:"\u0422\u0443\u0440\u0435\u0446\u043a\u0430\u044f"},"locale-uk":{"en-US":"Ukrainian",ru:"\u0423\u043a\u0440\u0430\u0438\u043d\u0441\u043a\u0430\u044f"},rules:{"en-US":"Rules",ru:"\u041f\u0440\u0430\u0432\u0438\u043b\u0430"},yabro:{"en-US":"Yandex.Browser",ru:"\u042f\u043d\u0434\u0435\u043a\u0441.\u0411\u0440\u0430\u0443\u0437\u0435\u0440\u0430"}},u={getItem:function(e){var t=void 0;if(window.localStorage)try{t=localStorage.getItem(e)}catch(e){console.log(e)}return t},setItem:function(e,t){if(window.localStorage)try{localStorage.setItem(e,t)}catch(e){console.log(e)}return this}},c=new(function(){function t(){var e=this;n(this,t),this.defaultLang="ru",this.langs=[{value:"ru",text:"Rus"},{value:"en-US",text:"Eng"}],this._elem=$(".lang-ui").click(function(t){e._next(),e.onChange(t,e.val())}),this._langsByValue={},this.langs.forEach(function(e,t){this._langsByValue[e.value]=e,e.index=t},this),this.val(u.getItem("settings.langUI")||this.defaultLang)}return i(t,[{key:"val",value:function(t){return void 0!==t&&("en"===t&&(t="en-US"),this._langsByValue[t])?(this._val=t,e.lang=t,u.setItem("settings.langUI",t),void this._update(t)):this._val}},{key:"_update",value:function(){this._elem.text(this._langsByValue[this.val()].text)}},{key:"_next",value:function(){var e=this._langsByValue[this.val()].index+1;e>=this.langs.length&&(e=0),this.val(this.langs[e].value)}}]),t}()),h={getDiffTitle:function(e){var t="";return"\xa0"===e?t="NO-BREAK SPACE":"\u202f"===e?t="NARROW NO-BREAK SPACE":"\u2011"===e&&(t="NON-BREAKING HYPHEN"),t},make:function(e,t){return window.JsDiff.diffChars(e,t).map(function(e){var t=o.escapeHTML(e.value),n=this.getDiffTitle(e.value);return e.added?'<ins class="diff" title="'+n+'">'+t+"</ins>":e.removed?'<del class="diff" title="'+n+'">'+t+"</del>":t},this).join("")}},d=function(e){return"en"===e||"en-US"===e?["en-US"]:[e,"en-US"]},f={getFilename:function(e){var t=o.isHTML(e)?"html":"txt",n=o.stripTags(e).replace(/\s+/g," ").trim();return(o.truncate(n,32)||"text")+"."+t},save:function(e,t){if(window.Blob){var n=e.value,i=new Blob([n],{type:"text/plain"}),s=document.createElement("a");s.download=this.getFilename(n),s.innerHTML="Download File",window.webkitURL?s.href=window.webkitURL.createObjectURL(i):(s.href=window.URL.createObjectURL(i),s.onclick=function(){document.body.removeChild(s)},s.style.display="none",document.body.appendChild(s)),s.click()}else window.alert(t)}},p=function(e,t,n,i){var s,a=0;return"boolean"!=typeof t&&(i=n,n=t,t=void 0),function(){function o(){a=Number(new Date),n.apply(r,u)}var r=this,l=Number(new Date)-a,u=arguments;i&&!s&&o(),s&&clearTimeout(s),void 0===i&&l>e?o():!0!==t&&(s=setTimeout(i?function(){s=void 0}:o,void 0===i?e-l:e))}},_=function(e,t,n){return void 0===n?p(e,t,!1):p(e,n,!1!==t)},g=window.Typograf,v=new g({disableRule:"*",enableRule:["common/nbsp/*","ru/nbsp/*"]}),m=new g({disableRule:"*",enableRule:["common/nbsp/*","common/punctuation/quote"],locale:["ru","en-US"]}),y=function(){function t(e){n(this,t),this._typograf=e,this._wasRebuilt=!1;var i=void 0;try{i=JSON.parse(u.getItem("settings.rules"))}catch(e){console.log(e)}this.locale=u.getItem("settings.locale"),this.mode=u.getItem("settings.mode"),this.onlyInvisible=u.getItem("settings.onlyInvisible"),i&&Array.isArray(i.disabled)&&Array.isArray(i.enabled)&&(this.rules=i),this.locale=this.locale||"ru",this.mode=this.mode||"",this.onlyInvisible=this.onlyInvisible||!1,this._events(),this.changeLangUI(),this._updateSelects()}return i(t,[{key:"show",value:function(){this._wasRebuilt||(this.rebuild(),this._wasRebuilt=!0),$(".prefs").addClass("prefs_opened"),$(".paranja").addClass("paranja_opened"),this._updateSelects(),this._synchronizeMainCheckbox()}},{key:"hide",value:function(){$(".prefs").removeClass("prefs_opened"),$(".paranja").removeClass("paranja_opened")}},{key:"toggle",value:function(){$(".prefs").is(".prefs_opened")?this.hide():this.show()}},{key:"save",value:function(){var e=[],t=[];Object.keys(this._typograf._enabledRules).forEach(function(n){this._typograf._enabledRules[n]?e.push(n):t.push(n)},this),u.setItem("settings.rules",JSON.stringify({enabled:e,disabled:t})).setItem("settings.locale",this.locale).setItem("settings.mode",this.mode).setItem("settings.onlyInvisible",this.onlyInvisible)}},{key:"byDefault",value:function(){var e=this;this._getCheckboxes().each(function(t,n){var i=(n=$(n)).data("id");g.prototype._rules.some(function(t){if(i===t.name){var s=!0!==t.disabled;return n.checked(s),s?e._typograf.enableRule(i):e._typograf.disableRule(i),!0}return!1})}),$(".prefs__all-rules").checked(void 0),$(".prefs__set-mode").val(""),$(".prefs__only-invisible").checked(!1),this.changeMode(),this.save(),this.onChange()}},{key:"changeLocale",value:function(){this.locale=$(".prefs__set-locale").val(),this.save(),this.onChange()}},{key:"changeLangUI",value:function(){this._updateLocaleOptions(),$("[data-text-id]").each(function(t,n){n.innerHTML=e(n.dataset.textId)}),$("[data-value-id]").each(function(t,n){n.value=e(n.dataset.valueId)}),$("[data-title-id]").each(function(t,n){n.title=e(n.dataset.titleId)}),$("[data-placeholder-id]").each(function(t,n){n.placeholder=e(n.dataset.placeholderId)}),this.rebuild(),this.save(),this.onChange()}},{key:"changeMode",value:function(){this.mode=$(".prefs__set-mode").val(),this.onlyInvisible=$(".prefs__only-invisible").checked(),this.save(),this.updateInvisibleSymbols(),this.onChange()}},{key:"updateInvisibleSymbols",value:function(){var t=m.execute(e("html-entities-example"),{htmlEntity:{type:this.mode,onlyInvisible:this.onlyInvisible}});t=o.escapeHTML(t).replace(/(&amp;#?[\da-z_-]+;)/gi,'<span style="color: green;">$1</span>'),$(".prefs__html-entities-example").html(t),$(".prefs__invisible-symbols-container")[this.mode?"show":"hide"]()}},{key:"onChange",value:function(){}},{key:"rebuild",value:function(){var t=this._getSortedGroups(g.prototype._rules,e.lang);$(".prefs__rules").html(this._buildHTML(t))}},{key:"_sortByGroupIndex",value:function(e){e.sort(function(e,t){if(!e.name||!t.name)return-1;var n=g.getGroupIndex(e._group),i=g.getGroupIndex(t._group);return n>i?1:n===i?0:-1})}},{key:"_splitGroups",value:function(e){var t=void 0,n=void 0,i=[];return e.forEach(function(e){var s=e._group;s!==t&&(t=s,n=[],i.push(n)),n.push(e)},this),i}},{key:"_sortGroupsByTitle",value:function(e,t){var n=g.titles;e.forEach(function(e){e.sort(function(e,i){var s=n[e.name],a=n[i.name];return(s[t]||s.common)>(a[t]||a.common)?1:-1})})}},{key:"_getSortedGroups",value:function(e,t){var n=[];e.forEach(function(e){e.live||n.push(e)}),this._sortByGroupIndex(n);var i=this._splitGroups(n);return this._sortGroupsByTitle(i,t),i}},{key:"_buildHTML",value:function(t){var n="",i=e.lang;return t.forEach(function(e){var t=e[0]._group,s=v.execute(g.getGroupTitle(t,i),{locale:d(i)});n+='<fieldset class="prefs__fieldset"><legend class="prefs__legend button">'+s+'</legend><div class="prefs__group-rules">',e.forEach(function(e){var t=e.name,s=t.split("/")[0],a="common"===s?"":'<span class="prefs__rule-lang">'+s+"</span>",r=g.titles[t];r&&(r[i]||r.common)||console.warn('Not found title for name "'+t+'".');var l=v.execute(o.escapeHTML(r[i]||r.common),{locale:d(i)}),u="setting-"+t,c=this._typograf.isEnabledRule(t);n+='<div class="prefs__rule" title="'+t+'"><input type="checkbox" class="prefs__rule-checkbox"'+(c?' checked="checked"':"")+' id="'+u+'" data-id="'+t+'" /> <label for="'+u+'">'+l+a+"</label></div>"},this),n+="</div></fieldset>"},this),n}},{key:"_getCheckboxes",value:function(){return $(".prefs__rule-checkbox")}},{key:"_clickRule",value:function(){var e=this;this._getCheckboxes().each(function(t,n){var i=(n=$(n)).data("id");n.checked()?e._typograf.enableRule(i):e._typograf.disableRule(i)}),this._synchronizeMainCheckbox(),this.save(),this.onChange()}},{key:"_clickLegend",value:function(){$(this).closest(".prefs__fieldset").toggleClass("prefs__fieldset_visible").find(".prefs__group-rules").slideToggle("fast")}},{key:"_selectAll",value:function(){var e=this,t=$(".prefs__all-rules").checked(),n=this._getCheckboxes();$.each(n,function(n,i){var s=(i=$(i)).data("id");i.checked(t),t?e._typograf.enableRule(s):e._typograf.disableRule(s)}),this.save(),this.onChange()}},{key:"_synchronizeMainCheckbox",value:function(){var e=0,t=void 0,n=this._getCheckboxes();n.each(function(t,n){n.checked&&e++}),t=e===n.length||!!e&&void 0,$(".prefs__all-rules").checked(t)}},{key:"_updateSelects",value:function(){$(".prefs__set-locale").val(this.locale),$(".prefs__set-mode").val(this.mode),$(".prefs__only-invisible").val(this.onlyInvisible),this.updateInvisibleSymbols()}},{key:"_updateLocaleOptions",value:function(){var t=g.getLocales().sort(function(t,n){return e("locale-"+t)>e("locale-"+n)?1:-1}).map(function(e){return'<option value="'+e+'" data-text-id="locale-'+e+'"></option>\n'}).join("");$(".prefs__set-locale").html(t).val(this.locale)}},{key:"_events",value:function(){$(".prefs__set-locale").on("change",this.changeLocale.bind(this)),$(".prefs__set-mode, .prefs__only-invisible").on("change",this.changeMode.bind(this)),$(".prefs__all-rules").on("click",this._selectAll.bind(this)),$(".prefs__default").on("click",this.byDefault.bind(this)),$(".prefs__close").on("click",this.hide.bind(this));var e=$(".prefs__rules");e.on("click",".prefs__legend",this._clickLegend),e.on("click",".prefs__rule-checkbox",this._clickRule.bind(this))}}]),t}(),b=new window.Typograf;new(function(){function t(){var e=this;n(this,t),this.last={value:"",result:""};var i=$(document.body);i.removeClass("transition_no"),this.isMobile=i.hasClass("page_is-mobile"),"#!prefs"===window.location.hash&&setTimeout(function(){e._onprefs()},1),this.isMobile||this._setValue(r.getHashParam("text")||""),this._prefs=new y(b),this._prefs.onChange=this.execute.bind(this),c.onChange=this._prefs.changeLangUI.bind(this._prefs),this._prefs.rules&&b.enableRule(this._prefs.rules.enabled).disableRule(this._prefs.rules.disabled),this.updateResult=_(250,this.updateResult),this._events(),this.execute()}return i(t,[{key:"copyText",value:function(t){try{t[0].select(),document.execCommand("copy")}catch(t){window.alert(e("notSupportCopy"))}}},{key:"execute",value:function(){var e=this._getValue(),t=b.execute(e,{locale:d(this._prefs.locale),htmlEntity:{type:this._prefs.mode}});this.last={value:e,result:t},this.isMobile?$(".input__text").val(t):this.updateResult()}},{key:"updateResult",value:function(){var e=this.last.value,t=this.last.result,n=$(".result__text"),i=$(".result__html"),s=$(".result__diff");n.is(":visible")&&n.val(t),i.is(":visible")&&i.html(function(e){return[[/(\u00A0|&nbsp;|&#160;)/g,"\xa0","NO-BREAK SPACE"],[/(\u202F|&#8239;)/g,"\u202f","NARROW NO-BREAK SPACE"],[/(\u2011|&#8209;)/g,"\u2011","NON-BREAKING HYPHEN"]].forEach(function(t){e=e.replace(t[0],'<span class="entity-nb" title="'+t[2]+'">'+t[1]+"</span>")}),e}(t)),s.is(":visible")&&s.html(h.make(e,t))}},{key:"_setValue",value:function(e){$(".input__text").val(e),this._updateValue(e)}},{key:"_getValue",value:function(){return $(".input__text").val()}},{key:"_updateValue",value:function(e){this.isMobile||"#!prefs"===window.location.hash||(window.location.hash="#!text="+window.encodeURIComponent(o.truncate(e,512))),this._updateClearText(e)}},{key:"_updateClearText",value:function(e){var t=$(".input__clear");e.length>0?t.show():t.hide()}},{key:"_events",value:function(){var t=this;window.addEventListener("message",function(e){var n=void 0;try{n=JSON.parse(e.data)}catch(e){return}n&&"typograf"===n.service&&"execute"===n.command&&e.source.postMessage(JSON.stringify({service:"typograf",command:"return",text:b.execute(n.text,{locale:d(t._prefs.locale),htmlEntity:{type:t._prefs.mode}})}),"*")},!1),this._onprefs=function(){var e=$(".header"),n=".header_selected";e.hasClass(n)?(window.location.hash="",setTimeout(function(){t.execute()},0)):window.location.hash="#!prefs",e.toggleClass(n),t._prefs.toggle()},$(".header, .paranja").on("click",this._onprefs),$(".result__as-text, .result__as-html, .result__as-diff").on("click",function(e){$(".result__text").hide().val(""),$(".result__html, .result__diff").hide().html(""),$(".result__"+e.target.value).show(),t.updateResult()}),$(".input__copy").on("click",function(){$(".result__as-text").click(),t.copyText($(".result__text"))}),$(".input__save").on("click",function(){f.save($(".result__text")[0],e("notSupportSave"))}),$(".input__clear").on("click",function(){t._setValue(""),$(".input__text").focus(),t.execute()});var n=null;this.isMobile?$(".input__execute").on("click",this.execute.bind(this)):$(".input__text").on("keyup input click",function(){var e=t._getValue();e!==n&&(n=e,t._updateValue(e),t.execute())})}}]),t}())}();